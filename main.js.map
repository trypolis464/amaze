{"version":3,"sources":["utilities.js","keycodes.js","input.js","soundObject.js","scrollingText.js","strings.js","tts.js","timer.js","oldtimer.js","map.js","game.js","main.js"],"names":["GameUtils","calculateDelta","lx","sx","sr","delta","progressPan","current","max","progressPitch","min","minPitch","maxPitch","progressVolume","minVolume","maxVolume","getProportion","distance3D","x1","y1","z1","x2","y2","z2","Math","sqrt","distance","jx","jy","kx","ky","calculateAngle","angle","atan2","PI","isCollide3D","a","b","x","width","y","height","z","depth","randomInt","floor","random","getRandomArbitrary","sleep","ms","Promise","resolve","setTimeout","percent","int1","int2","percentOf","percentage","percented","value","average","arr","startIndex","len","length","val","i","averageInt","neg","num","numericSort","shuffle","j","objSize","obj","size","key","hasOwnProperty","copyObject","Object","assign","create","getPrototypeOf","arraysEqual","arr1","arr2","pauseTimeout","timerId","Date","now","clearTimeout","resumeTimeout","window","remaining","start","callback","randomProperty","keys","findFiles","path","ext","list","fileExt","walk","filesSync","pb","pf","stat","next","push","substr","findFolders","dirsSync","getReadableTime","milliseconds","seconds","minutes","hours","days","parseInt","this1","toString","this2","plural","this3","this4","number","str1","str2","utils","KeyEvent","DOM_VK_CANCEL","DOM_VK_HELP","DOM_VK_BACK_SPACE","DOM_VK_TAB","DOM_VK_CLEAR","DOM_VK_RETURN","DOM_VK_ENTER","DOM_VK_SHIFT","DOM_VK_CONTROL","DOM_VK_ALT","DOM_VK_PAUSE","DOM_VK_CAPS_LOCK","DOM_VK_ESCAPE","DOM_VK_SPACE","DOM_VK_PAGE_UP","DOM_VK_PAGE_DOWN","DOM_VK_END","DOM_VK_HOME","DOM_VK_LEFT","DOM_VK_UP","DOM_VK_RIGHT","DOM_VK_DOWN","DOM_VK_PRINTSCREEN","DOM_VK_INSERT","DOM_VK_DELETE","DOM_VK_0","DOM_VK_1","DOM_VK_2","DOM_VK_3","DOM_VK_4","DOM_VK_5","DOM_VK_6","DOM_VK_7","DOM_VK_8","DOM_VK_9","DOM_VK_SEMICOLON","DOM_VK_EQUALS","DOM_VK_A","DOM_VK_B","DOM_VK_C","DOM_VK_D","DOM_VK_E","DOM_VK_F","DOM_VK_G","DOM_VK_H","DOM_VK_I","DOM_VK_J","DOM_VK_K","DOM_VK_L","DOM_VK_M","DOM_VK_N","DOM_VK_O","DOM_VK_P","DOM_VK_Q","DOM_VK_R","DOM_VK_S","DOM_VK_T","DOM_VK_U","DOM_VK_V","DOM_VK_W","DOM_VK_X","DOM_VK_Y","DOM_VK_Z","DOM_VK_CONTEXT_MENU","DOM_VK_NUMPAD0","DOM_VK_NUMPAD1","DOM_VK_NUMPAD2","DOM_VK_NUMPAD3","DOM_VK_NUMPAD4","DOM_VK_NUMPAD5","DOM_VK_NUMPAD6","DOM_VK_NUMPAD7","DOM_VK_NUMPAD8","DOM_VK_NUMPAD9","DOM_VK_MULTIPLY","DOM_VK_ADD","DOM_VK_SEPARATOR","DOM_VK_SUBTRACT","DOM_VK_DECIMAL","DOM_VK_DIVIDE","DOM_VK_F1","DOM_VK_F2","DOM_VK_F3","DOM_VK_F4","DOM_VK_F5","DOM_VK_F6","DOM_VK_F7","DOM_VK_F8","DOM_VK_F9","DOM_VK_F10","DOM_VK_F11","DOM_VK_F12","DOM_VK_F13","DOM_VK_F14","DOM_VK_F15","DOM_VK_F16","DOM_VK_F17","DOM_VK_F18","DOM_VK_F19","DOM_VK_F20","DOM_VK_F21","DOM_VK_F22","DOM_VK_F23","DOM_VK_F24","DOM_VK_NUM_LOCK","DOM_VK_SCROLL_LOCK","DOM_VK_COMMA","DOM_VK_PERIOD","DOM_VK_SLASH","DOM_VK_BACK_QUOTE","DOM_VK_OPEN_BRACKET","DOM_VK_BACK_SLASH","DOM_VK_CLOSE_BRACKET","DOM_VK_QUOTE","DOM_VK_META","EventEmitter","require","KeyboardInput","constructor","keyDown","justPressed","chars","justReleased","justPressedEventCallback","charEventCallback","init","that","document","addEventListener","event","handleKeyDown","handleKeyUp","handleChar","pause","isPaused","resume","which","emit","char","console","log","String","fromCharCode","destroy","isDown","isJustPressed","isJustReleased","keysDown","kd","forEach","v","getChars","keysPressed","splice","releaseAllKeys","keysReleased","playOnceTimer","panner","defaults","panningModel","maxDistance","sono","playInBackground","SoundObjectItem","file","tag","stream","duckingFirstTime","fileName","sound","src","onComplete","doneLoading","timeout","checkProgress","loaded","Audio","data","playbackRate","pitch","loop","progress","replay","stop","play","err","unload","duck","time","oldVolume","volume","fade","unduck","pos","forcePlay","playSync","die","inp","evt","once","removeAllListeners","active","playing","pan","currentPan","effects","add","set","seek","currentTime","duration","position","SoundObject","sounds","Array","loadingQueue","queueCallback","loadedSounds","loadingSounds","loadedCallback","queue","queueLength","statusCallback","directory","extension","oneShots","debug","oneShotSound","setStatusCallback","findSound","findSoundIndex","resetQueuedInstance","found","returnObject","loadQueueSync","so","setQueueCallback","loadQueue","createSync","snd","enqueue","handleQueue","resetQueue","setCallback","isLoading","playOnce","on","noMore","filename","kill","destroyAll","undefined","runningText","ScrollingText","text","delimiter","splitText","split","currentLine","sndOpen","sndContinue","sndClose","getElementById","prom","res","handleKeys","readCurrentLine","copyCurrentLine","advance","handleTap","action","str","speak","removeEventListener","Strings","strings","selectVoice","mSelectVoice","mLang","newUpdate","mSapi","mReader","newRate","rating","mRate","K","Q","A","J","cspades","cdiamonds","cclubs","chearts","dq","lang","langs","mainmenu","mSelect","mBack","mStart","yes","no","ok","get","what","rep","i1","Number","replace","check","lng","app","remote","useWebTTS","TTS","webTTS","voices","speechController","ducking","synth","Speech","rate","interrupt","VK_CONTROL","splitSentences","then","catch","e","setLanguage","setRate","r","accessibilitySupportEnabled","listeners","onstart","onend","onerror","innerHTML","para","createElement","appendChild","createTextNode","setWebTTS","tts","cancel","changeRate","speech","changeVoice","name","voiceArray","k","includes","setVoice","cb","silent","wl","input","selection","ducker","OldTimer","run","elapsed","paused","lastTime","pauseWhen","started","isActive","performance","reset","restart","Map","maxX","maxY","tiles","spawnPlatform","minX","minY","tile","Tile","getTileAt","temp","here","surface","Game","timer","update","render","level","walkTime","walkTimer","map","gameTimer","dt","playSteps","dir","ttsVoice","gameID","ttsRate","setup","focus"],"mappings":"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","file":"main.js","sourceRoot":"js","sourcesContent":["import 'babel-polyfill';\r\n\r\n'use strict';\r\n\r\nclass GameUtils {\r\n  calculateDelta(lx, sx, sr = 0) {\r\n    sx = sx + sr;\r\n    if (sx < lx) {\r\n      delta = lx - sx;\r\n    }\r\n    if (sx > lx) {\r\n      delta = sx - lx;\r\n    }\r\n  }\r\n\r\n  progressPan(current, max) {\r\n    return ((current * 200 / max) - 100) / 100;\r\n  }\r\n\r\n  progressPitch(current, min, max, minPitch, maxPitch) {\r\n    return (current / (min + max)) * (maxPitch - minPitch) + minPitch;\r\n  }\r\n\r\n  progressVolume(current, min, max, minVolume, maxVolume) {\r\n    if (current > max) {\r\n      return 0;\r\n    }\r\n\r\n    return (current / (min + max)) * (maxVolume - minVolume) + minVolume;\r\n  }\r\n\r\n  getProportion(current, min, max, minVolume, maxVolume) {\r\n    if (current > max) {\r\n      return 0;\r\n    }\r\n\r\n    return (current / (min + max)) * (maxVolume - minVolume) + minVolume;\r\n  }\r\n\r\n  distance3D(x1, y1, z1, x2, y2, z2) {\r\n    return Math.sqrt((x2 - x1) * (x2 - x1) +\r\n      (y2 - y1) * (y2 - y1) +\r\n      (z2 - z1) * (z2 - z1));\r\n  }\r\n\r\n  distance(jx, jy, kx, ky) {\r\n    // Return Math.hypot(jx-kx, jy-ky)\r\n    return Math.sqrt(((jx - kx) * (jx - kx)) + ((jy - ky)) * (jy - ky));\r\n  }\r\n\r\n  calculateAngle(x1, y1, x2, y2) {\r\n    let angle = Math.atan2((y2 - y1), (x2 - x1));\r\n    angle = (angle >= 0) ? 0 : (2 * Math.PI) + angle;\r\n    return angle;\r\n    // Return Math.atan2((y2 - y1),(x2 - x1));\r\n  }\r\n\r\n  isCollide3D(a, b) {\r\n    return (a.x <= (b.x + b.width) && (a.x + a.width) >= b.x) && (a.y <= (b.y + b.height) && (a.y + a.height) >= b.y) && (a.z <= (b.z + b.depth) && (a.z + a.depth) >= b.z);\r\n  }\r\n\r\n  randomInt(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n  }\r\n\r\n  getRandomArbitrary(min, max) {\r\n    return Math.random() * (max - min) + min;\r\n  }\r\n\r\n  sleep(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  percent(int1, int2) {\r\n    return int1 * 100 / int2;\r\n  }\r\n\r\n  percentOf(int1, int2) {\r\n    return int2 * int1 / 100;\r\n  }\r\n  percentage(percented, value) {\r\n    return value * percented / 100;\r\n  }\r\n\r\n  average(arr, startIndex = 0) {\r\n    const len = arr.length;\r\n    let val = 0;\r\n    let average = 0;\r\n    if (arr.length < startIndex) {\r\n      return -1;\r\n    }\r\n\r\n    for (let i = startIndex; i < arr.length; i++) {\r\n      val += arr[i];\r\n    }\r\n\r\n    average = val / (len - startIndex);\r\n    return average;\r\n  }\r\n\r\n  averageInt(arr, startIndex = 0) {\r\n    const len = arr.length;\r\n    let val = 0;\r\n    let average = 0;\r\n    if (arr.length < startIndex) {\r\n      return -1;\r\n    }\r\n\r\n    for (let i = startIndex; i < arr.length; i++) {\r\n      val += arr[i];\r\n    }\r\n\r\n    average = val / (len - startIndex);\r\n    return Math.floor(average);\r\n  }\r\n\r\n  neg(num) {\r\n    return (num >= 0 ? (num == 0 ? 0 : 1) : -1);\r\n  }\r\n\r\n  numericSort(a, b) {\r\n    return (a < b ? -1 : (a == b ? 0 : 1));\r\n  }\r\n\r\n  shuffle(a) {\r\n    for (let i = a.length - 1; i > 0; i--) {\r\n      const j = Math.floor(Math.random() * (i + 1));\r\n      [a[i], a[j]] = [a[j], a[i]];\r\n    }\r\n\r\n    return a;\r\n  }\r\n\r\n  objSize(obj) {\r\n    let size = 0;\r\n\r\n    let key;\r\n    for (key in obj) {\r\n      if (obj.hasOwnProperty(key)) {\r\n        size++;\r\n      }\r\n    }\r\n\r\n    return size;\r\n  }\r\n  copyObject(obj) {\r\n    return Object.assign(Object.create(Object.getPrototypeOf(obj)), obj);\r\n  }\r\n  arraysEqual(arr1, arr2) {\r\n    for (var i = 0; i < arr1.length; i++) {\r\n\r\n      if (arr1[i] !== arr2[i])\r\n        return false;\r\n\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  pauseTimeout(timerId) {\r\n    let start = Date.now();\r\n    clearTimeout(timerId);\r\n  };\r\n\r\n  resumeTimeout(timerId) {\r\n    remaining -= Date.now() - start;\r\n    return window.setTimeout(callback, remaining);\r\n  };\r\n  randomProperty(obj) {\r\n    var keys = Object.keys(obj)\r\n    return obj[keys[keys.length * Math.random() << 0]];\r\n  };\r\n    async findFiles(path,ext='') {\r\nlet list=[];\r\nlet fileExt='';\r\nawait walk.filesSync(path, (pb, pf, stat, next) => {\r\nif (ext=='') {\r\nlist.push(pf);\r\n}\r\nelse {\r\nfileExt=pf.substr(0-ext.length,ext.length);\r\nif (fileExt==ext) {\r\nlist.push(pf);\r\n}\r\n}\r\n});\r\nreturn list;\r\n}\r\nasync findFolders(path) {\r\nlet list=[];\r\nawait walk.dirsSync(path, (pb, pf, stat, next) => {\r\nlist.push(pf);\r\n});\r\nreturn list;\r\n}\r\n\r\n  getReadableTime(milliseconds) {\r\n    milliseconds = Math.floor(milliseconds);\r\n    let seconds = Math.floor((milliseconds / 1000) % 60);\r\n    let minutes = Math.floor(((milliseconds / (1000 * 60)) % 60));\r\n    let hours = Math.floor(((milliseconds / (1000 * 60 * 60)) % 24));\r\n    let days = parseInt(milliseconds / 1000 / 60 / 60 / 24);\r\n    days = Math.floor(days);\r\n    hours = Math.floor(hours);\r\n    minutes = Math.floor(minutes);\r\n    seconds = Math.floor(seconds);\r\n    let this1 = '';\r\n    if (days > 0) {\r\n      this1 = parseInt(days).toString() + ':';\r\n    }\r\n    let this2 = '';\r\n    if (hours > 0) {\r\n      this2 = parseInt(hours).toString() + ' ' + this.plural(hours, 'hour', 'hours') + ', '\r\n    }\r\n    let this3 = '';\r\n    if (minutes > 0) {\r\n      this3 = parseInt(minutes).toString() + ' ' + this.plural(minutes, 'minute', 'minutes') + ', ';\r\n    }\r\n    let this4 = parseInt(seconds).toString() + ' ' + this.plural(seconds, 'second', 'seconds');\r\n    return this4;\r\n  }\r\n\r\n  plural(number, str1, str2) {\r\n    // Todo: Make this use ternerary, making it faster and shorter.\r\n    if (number == 1 || number == -1) {\r\n      return str1;\r\n    } else {\r\n      return str2;\r\n    }\r\n  }\r\n}\r\n\r\nexport var utils = new GameUtils();\r\n","\r\n'use strict';\r\nconst KeyEvent = {\r\nDOM_VK_CANCEL: 3,\r\n\t       DOM_VK_HELP: 6,\r\n\t       DOM_VK_BACK_SPACE: 8,\r\n\t       DOM_VK_TAB: 9,\r\n\t       DOM_VK_CLEAR: 12,\r\n\t       DOM_VK_RETURN: 13,\r\n\t       DOM_VK_ENTER: 14,\r\n\t       DOM_VK_SHIFT: 16,\r\n\t       DOM_VK_CONTROL: 17,\r\n\t       DOM_VK_ALT: 18,\r\n\t       DOM_VK_PAUSE: 19,\r\n\t       DOM_VK_CAPS_LOCK: 20,\r\n\t       DOM_VK_ESCAPE: 27,\r\n\t       DOM_VK_SPACE: 32,\r\n\t       DOM_VK_PAGE_UP: 33,\r\n\t       DOM_VK_PAGE_DOWN: 34,\r\n\t       DOM_VK_END: 35,\r\n\t       DOM_VK_HOME: 36,\r\n\t       DOM_VK_LEFT: 37,\r\n\t       DOM_VK_UP: 38,\r\n\t       DOM_VK_RIGHT: 39,\r\n\t       DOM_VK_DOWN: 40,\r\n\t       DOM_VK_PRINTSCREEN: 44,\r\n\t       DOM_VK_INSERT: 45,\r\n\t       DOM_VK_DELETE: 46,\r\n\t       DOM_VK_0: 48,\r\n\t       DOM_VK_1: 49,\r\n\t       DOM_VK_2: 50,\r\n\t       DOM_VK_3: 51,\r\n\t       DOM_VK_4: 52,\r\n\t       DOM_VK_5: 53,\r\n\t       DOM_VK_6: 54,\r\n\t       DOM_VK_7: 55,\r\n\t       DOM_VK_8: 56,\r\n\t       DOM_VK_9: 57,\r\n\t       DOM_VK_SEMICOLON: 59,\r\n\t       DOM_VK_EQUALS: 61,\r\n\t       DOM_VK_A: 65,\r\n\t       DOM_VK_B: 66,\r\n\t       DOM_VK_C: 67,\r\n\t       DOM_VK_D: 68,\r\n\t       DOM_VK_E: 69,\r\n\t       DOM_VK_F: 70,\r\n\t       DOM_VK_G: 71,\r\n\t       DOM_VK_H: 72,\r\n\t       DOM_VK_I: 73,\r\n\t       DOM_VK_J: 74,\r\n\t       DOM_VK_K: 75,\r\n\t       DOM_VK_L: 76,\r\n\t       DOM_VK_M: 77,\r\n\t       DOM_VK_N: 78,\r\n\t       DOM_VK_O: 79,\r\n\t       DOM_VK_P: 80,\r\n\t       DOM_VK_Q: 81,\r\n\t       DOM_VK_R: 82,\r\n\t       DOM_VK_S: 83,\r\n\t       DOM_VK_T: 84,\r\n\t       DOM_VK_U: 85,\r\n\t       DOM_VK_V: 86,\r\n\t       DOM_VK_W: 87,\r\n\t       DOM_VK_X: 88,\r\n\t       DOM_VK_Y: 89,\r\n\t       DOM_VK_Z: 90,\r\n\t       DOM_VK_CONTEXT_MENU: 93,\r\n\t       DOM_VK_NUMPAD0: 96,\r\n\t       DOM_VK_NUMPAD1: 97,\r\n\t       DOM_VK_NUMPAD2: 98,\r\n\t       DOM_VK_NUMPAD3: 99,\r\n\t       DOM_VK_NUMPAD4: 100,\r\n\t       DOM_VK_NUMPAD5: 101,\r\n\t       DOM_VK_NUMPAD6: 102,\r\n\t       DOM_VK_NUMPAD7: 103,\r\n\t       DOM_VK_NUMPAD8: 104,\r\n\t       DOM_VK_NUMPAD9: 105,\r\n\t       DOM_VK_MULTIPLY: 106,\r\n\t       DOM_VK_ADD: 107,\r\n\t       DOM_VK_SEPARATOR: 108,\r\n\t       DOM_VK_SUBTRACT: 109,\r\n\t       DOM_VK_DECIMAL: 110,\r\n\t       DOM_VK_DIVIDE: 111,\r\n\t       DOM_VK_F1: 112,\r\n\t       DOM_VK_F2: 113,\r\n\t       DOM_VK_F3: 114,\r\n\t       DOM_VK_F4: 115,\r\n\t       DOM_VK_F5: 116,\r\n\t       DOM_VK_F6: 117,\r\n\t       DOM_VK_F7: 118,\r\n\t       DOM_VK_F8: 119,\r\n\t       DOM_VK_F9: 120,\r\n\t       DOM_VK_F10: 121,\r\n\t       DOM_VK_F11: 122,\r\n\t       DOM_VK_F12: 123,\r\n\t       DOM_VK_F13: 124,\r\n\t       DOM_VK_F14: 125,\r\n\t       DOM_VK_F15: 126,\r\n\t       DOM_VK_F16: 127,\r\n\t       DOM_VK_F17: 128,\r\n\t       DOM_VK_F18: 129,\r\n\t       DOM_VK_F19: 130,\r\n\t       DOM_VK_F20: 131,\r\n\t       DOM_VK_F21: 132,\r\n\t       DOM_VK_F22: 133,\r\n\t       DOM_VK_F23: 134,\r\n\t       DOM_VK_F24: 135,\r\n\t       DOM_VK_NUM_LOCK: 144,\r\n\t       DOM_VK_SCROLL_LOCK: 145,\r\n\t       DOM_VK_COMMA: 188,\r\n\t       DOM_VK_PERIOD: 190,\r\n\t       DOM_VK_SLASH: 191,\r\n\t       DOM_VK_BACK_QUOTE: 192,\r\n\t       DOM_VK_OPEN_BRACKET: 219,\r\n\t       DOM_VK_BACK_SLASH: 220,\r\n\t       DOM_VK_CLOSE_BRACKET: 221,\r\n\t       DOM_VK_QUOTE: 222,\r\n\t       DOM_VK_META: 224\r\n};\r\nexport {KeyEvent};\r\n","import $ from 'jquery';\r\nconst EventEmitter = require('events');\r\n'use strict';\r\nclass KeyboardInput extends EventEmitter {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.keyDown = [];\r\n\t\tthis.justPressed = [];\r\n\t\tthis.chars = [];\r\n\t\tthis.justReleased = [];\r\n\t\tthis.justPressedEventCallback = null;\r\n\t\tthis.charEventCallback = null;\r\n\t}\r\n\r\n\tinit() {\r\n\t\tconst that = this;\r\n\t\t// \t\t$(document).keydown(function(event) { that.handleKeyDown(event); });\r\n\t\t// \t\t$(document).keyup(function(event) { that.handleKeyUp(event); });\r\n\t\tdocument.addEventListener('keydown', event => {\r\n\t\t\tthat.handleKeyDown(event);\r\n\t\t});\r\n\t\tdocument.addEventListener('keyup', event => {\r\n\t\t\tthat.handleKeyUp(event);\r\n\t\t});\r\n\t\tdocument.addEventListener('keypress', event => {\r\n\t\t\tthat.handleChar(event);\r\n\t\t});\r\n\t}\r\n\tpause() {\r\n\t\tthis.isPaused = true;\r\n\t}\r\n\tresume() {\r\n\t\tthis.isPaused = false;\r\n\t}\r\n\thandleKeyDown(event) {\r\n\t\tif (this.keyDown[event.which] != true || typeof this.keyDown[event.which] === 'undefined') {\r\n\t\t\tthis.keyDown[event.which] = true;\r\n\t\t\tthis.justPressed[event.which] = true;\r\n\t\t\tthis.emit(event.which);\r\n\t\t\tthis.justReleased[event.which] = false;\r\n\t\t\tif (typeof this.justPressedEventCallback !== 'undefined' && this.justPressedEventCallback != null) {\r\n\t\t\t\tthis.justPressedEventCallback(event.which);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thandleChar(char) {\r\n\t\tconsole.log(\"char handled\", char)\r\n\t\tif (char.which < 48 || char.which > 122) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (String.fromCharCode(char.which) != '') {\r\n\t\t\tthis.chars += String.fromCharCode(char.which);\r\n\t\t\tthis.emit(\"chr\" + String.fromCharCode(char.which));\r\n\t\t\tif (typeof this.charEventCallback !== 'undefined' && this.charEventCallback != null) {\r\n\t\t\t\tthis.charEventCallback(String.fromCharCode(char.which));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thandleKeyUp(event) {\r\n\t\tif (this.keyDown[event.which] == true) {\r\n\t\t\tthis.keyDown[event.which] = false;\r\n\t\t\tthis.justPressed[event.which] = false;\r\n\t\t\tthis.justReleased[event.which] = true;\r\n\t\t\tthis.emit(\"!\" + event.which);\r\n\t\t}\r\n\t\tthis.chars = '';\r\n\t}\r\n\tdestroy() {\r\n\t\tthis.charEventCallback = null;\r\n\t\tthis.justPressedEventCallback = null;\r\n\t}\r\n\tisDown(event) {\r\n\t\tif (this.isPaused) return false;\r\n\t\treturn this.keyDown[event];\r\n\t}\r\n\r\n\tisJustPressed(event) {\r\n\t\tif (this.isPaused) return false;\r\n\t\tif (this.justPressed[event] == true) {\r\n\t\t\tthis.justPressed[event] = false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisJustReleased(event) {\r\n\t\tif (this.justReleased[event]) {\r\n\t\t\tthis.justReleased[event] = false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tkeysDown() {\r\n\t\tconst kd = [];\r\n\t\tthis.keyDown.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn kd;\r\n\t}\r\n\r\n\tgetChars() {\r\n\t\tconst kd = this.chars;\r\n\t\tthis.chars = '';\r\n\t\treturn kd;\r\n\t}\r\n\r\n\tkeysPressed() {\r\n\t\tconst kd = [];\r\n\t\tthis.justPressed.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.justPressed.splice();\r\n\t\treturn kd;\r\n\t}\r\n\r\n\treleaseAllKeys() {\r\n\r\n\t}\r\n\r\n\tkeysReleased() {\r\n\t\tconst kd = [];\r\n\t\tthis.justReleased.forEach((v, i) => {\r\n\t\t\tif (v) {\r\n\t\t\t\tkd.push(i);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.justReleased.splice();\r\n\t\treturn kd;\r\n\t}\r\n}\r\n\r\nexport { KeyboardInput };\r\n","import \"babel-polyfill\";\r\nimport { report } from './main';\r\nimport { speech } from './tts';\r\nimport panner from 'sono/effects/panner';\r\nconst EventEmitter = require('events');\r\nimport sono from 'sono';\r\nimport { KeyboardInput } from './input';\r\nimport { KeyEvent } from './keycodes';\r\nimport { utils } from './utilities';\r\npanner.defaults = {\r\n\tpanningModel: 'HRTF',\r\n\tmaxDistance: 50,\r\n};\r\nsono.playInBackground = true;\r\nvar playOnceTimer;\r\nclass SoundObjectItem extends EventEmitter {\r\n\tconstructor(file, callback = 0, tag = 0, stream = false) {\r\n\t\tsuper();\r\n\t\tthis.duckingFirstTime = true;\r\n\t\tthis.stream = stream;\r\n\t\tthis.panner = null;\r\n\t\tthis.fileName = file;\r\n\t\tif (typeof file == \"string\") {\r\n\t\t\tif (!stream) {\r\n\t\t\t\tthis.sound = sono.create({\r\n\t\t\t\t\tsrc: file,\r\n\t\t\t\t\tonComplete: () => { this.doneLoading(); }\r\n\t\t\t\t});\r\n\t\t\t\tthis.timeout = setTimeout(() => { this.checkProgress(); }, 2000);\r\n\t\t\t\tthis.loaded = false;\r\n\t\t\t\tthis.callback = callback;\r\n\t\t\t\tthis.tag = tag;\r\n\t\t\t}\r\n\t\t\tif (stream) {\r\n\t\t\t\tthis.loaded = true;\r\n\t\t\t\tthis.callback = callback;\r\n\t\t\t\tthis.tag = tag;\r\n\t\t\t\tthis.sound = sono.create(new Audio(file));\r\n\t\t\t\tthis.doneLoading();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (typeof file == \"object\") {\r\n\t\t\tthis.sound = sono.create(\"\");\r\n\t\t\tthis.sound.data = file;\r\n\t\t\tthis.loaded = false;\r\n\t\t\tthis.callback = callback;\r\n\t\t\tthis.tag = tag;\r\n\t\t\tthis.doneLoading();\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tget playbackRate() {\r\n\t\treturn this.sound.playbackRate\r\n\t}\r\n\r\n\tset playbackRate(v) {\r\n\t\treturn this.sound.playbackRate = v;\r\n\t}\r\n\tget pitch() {\r\n\t\treturn this.sound.playbackRate\r\n\t}\r\n\r\n\tset pitch(v) {\r\n\t\treturn this.sound.playbackRate = v;\r\n\t}\r\n\r\n\tset loop(v) {\r\n\t\tthis.sound.loop = v;\r\n\t}\r\n\r\n\tcheckProgress() {\r\n\t\tif (this.stream) return;\r\n\t\tif (this.sound.progress == 0) {\r\n\t\t\tthis.sound.destroy();\r\n\t\t\tthis.sound = sono.create({ src: this.fileName, onComplete: () => { this.doneLoading(); } }, this.stream);\r\n\t\t}\r\n\r\n\t\tif (this.sound.progress == 1) {\r\n\t\t\tthis.doneLoading();\r\n\t\t} else {\r\n\t\t\tthis.timeout = setTimeout(() => { this.checkProgress(); }, 500);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tdoneLoading() {\r\n\t\tif (!this.stream) clearTimeout(this.timeout);\r\n\t\tthis.loaded = true;\r\n\t\tif (this.callback != 0) {\r\n\t\t\tthis.callback();\r\n\t\t}\r\n\t}\r\n\treplay() {\r\n\t\tthis.sound.stop()\r\n\t\tthis.sound.play()\r\n\t}\r\n\tplay() {\r\n\t\t//sometimes, html element sounds complain about having a different connection, so wrap it in a try catch block.\r\n\t\ttry {\r\n\t\t\tthis.sound.play();\r\n\t\t} catch (err) {\r\n\t\t\t//report(err);\r\n\t\t\t//recreate the sound and replay\r\n\t\t\tif (this.stream) this.sound = sono.create(new Audio(this.fileName));\r\n\t\t\tif (!this.stream) this.sound = sono.create({\r\n\t\t\t\tsrc: this.fileName,\r\n\t\t\t\tonComplete: () => { this.doneLoading(); }\r\n\t\t\t});\r\n\t\t\tthis.sound.play();\r\n\t\t}\r\n\t}\r\n\tstop() {\r\n\t\tthis.sound.stop();\r\n\r\n\t}\r\n\tpause() {\r\n\t\tthis.sound.pause();\r\n\t}\r\n\tresume() {\r\n\t\tthis.sound.resume();\r\n\t}\r\n\tdestroy() {\r\n\t\ttry {\r\n\r\n\t\t\tthis.sound.destroy();\r\n\t\t} catch (err) {\r\n\r\n\t\t}\r\n\t}\r\n\tunload() { this.sound.destroy(); }\r\n\tduck(time) {\r\n\t\tif (this.duckingFirstTime) this.oldVolume = this.volume;\r\n\t\tthis.duckingFirstTime = false;\r\n\t\tthis.sound.fade(0.3, 0.15);\r\n\t}\r\n\tunduck(time) {\r\n\t\tthis.sound.fade(this.oldVolume, 0.15);\r\n\t}\r\n\tasync fade(time) {\r\n\t\tthis.sound.fade(0, time / 1000);\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.sound.stop();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t}, time);// End\r\n\t\t});// Promise\r\n\r\n\t}\r\n\r\n\tpos(x, y, z) {\r\n\r\n\t}\r\n\r\n\tforcePlay() {\r\n\t\tthis.sound.stop();\r\n\t\tthis.sound.play();\r\n\t}\r\n\tasync playSync(die = false) {\r\n\t\tconst inp = new KeyboardInput();\r\n\t\tinp.init();\r\n\t\tthis.sound.play();\r\n\r\n\t\tinp.justPressedEventCallback = (evt => {\r\n\t\t\tif (evt == KeyEvent.DOM_VK_Q || evt == KeyEvent.DOM_VK_X || evt == KeyEvent.DOM_VK_ESCAPE || evt == KeyEvent.DOM_VK_SPACE || evt == KeyEvent.DOM_VK_ENTER) {\r\n\t\t\t\tthis.sound.stop();\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.sound.once('ended', () => {\r\n\t\t\t\tthis.sound.removeAllListeners();\r\n\t\t\t\tif (die) this.sound.destroy();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t});// End\r\n\t\t\tthis.sound.once('stop', () => {\r\n\t\t\t\tthis.sound.removeAllListeners();\r\n\t\t\t\tif (die) this.sound.destroy();\r\n\t\t\t\tresolve('ok');\r\n\t\t\t\tinp.justPressedEventCallback = null;\r\n\t\t\t});// Stop\r\n\t\t});// Promise\r\n\t}\r\n\r\n\tget active() {\r\n\t\tif (!this.sound.loaded) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (this.sound.progress < 1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.sound.loaded) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t}\r\n\tget playing() {\r\n\t\treturn this.sound.playing;\r\n\t}\r\n\r\n\tget pan() {\r\n\t\tif (!this.panner) {\r\n\t\t\tthis.panner = this.sound.effects.add(panner());\r\n\t\t\tthis.currentPan = 0;\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this.currentPan;\r\n\t}\r\n\r\n\tset pan(v) {\r\n\t\tif (!this.panner) {\r\n\t\t\tthis.panner = this.sound.effects.add(panner());\r\n\t\t}\r\n\t\tthis.currentPan = v;\r\n\t\treturn this.panner.set(v);\r\n\t}\r\n\tget volume() {\r\n\t\treturn this.sound.volume;\r\n\t}\r\n\tset volume(v) {\r\n\t\tthis.sound.volume = v;\r\n\t}\r\n\r\n\tseek(time) {\r\n\t\treturn this.sound.seek(time);\r\n\t}\r\n\r\n\tget currentTime() {\r\n\t\treturn this.sound.currentTime;\r\n\t}\r\n\r\n\tget duration() {\r\n\t\treturn this.sound.duration * 1000;\r\n\t}\r\n\r\n\tget position() {\r\n\t\treturn this.sound.currentTime;\r\n\t}\r\n\r\n\tset currentTime(v) {\r\n\t\treturn this.sound.seek(v);\r\n\t}\r\n\r\n}\r\n\r\nclass SoundObject {\r\n\tconstructor() {\r\n\t\tthis.sounds = new Array();\r\n\t\tthis.loadingQueue = false;\r\n\t\tthis.queueCallback = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tthis.loadedCallback = 0;\r\n\t\tthis.queue = new Array();\r\n\t\tthis.queueLength = 0;\r\n\t\tthis.statusCallback = null;\r\n\t\tthis.directory = \"./sounds/\";\r\n\t\tthis.extension = \".ogg\";\r\n\t\tthis.oneShots = new Array();\r\n\t\tthis.debug = false;\r\n\r\n\r\n\t\tthis.oneShotSound = null;\r\n\t}\r\n\tsetStatusCallback(callback) {\r\n\t\tthis.statusCallback = callback;\r\n\t}\r\n\tfindSound(file) {\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (this.sounds[i].fileName == file && this.sounds[i].loaded) {\r\n\t\t\t\treturn this.sounds[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\tfindSoundIndex(file) {\r\n\t\tfor (const i in this.sounds) {\r\n\t\t\tif (this.sounds[i].fileName == file) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\r\n\r\n\tresetQueuedInstance() {\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (typeof this.sounds[i] != \"undefined\") {\r\n\t\t\t\tif (this.sounds[i].tag == 1) {\r\n\t\t\t\t\tthis.sounds[i].sound.destroy();\r\n\t\t\t\t\tthis.sounds.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.loadingQueue = false;\r\n\t\tthis.queueCallback = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tthis.loadedCallback = 0;\r\n\t\tthis.queue = new Array();\r\n\t\tthis.queueLength = 0;\r\n\t\tthis.statusCallback = null;\r\n\t}\r\n\r\n\r\n\r\n\tcreate(file, stream = false) {\r\n\t\tfile = this.directory + file + this.extension;\r\n\t\tlet found = -1;\r\n\t\tfound = this.findSound(file);\r\n\t\tlet returnObject = null;\r\n\t\tif (found == -1 || found.sound.data == null) {\r\n\t\t\treturnObject = new SoundObjectItem(file, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\tthis.sounds.push(returnObject);\r\n\t\t} else {\r\n\t\t\treturnObject = new SoundObjectItem(found.sound.data, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\treturnObject.fileName = found.fileName;\r\n\t\t}\r\n\t\treturnObject.fileName = file; //otherwise html element fileNames get fucked up.\r\n\t\treturn returnObject;\r\n\t}\r\n\tasync loadQueueSync() {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tso.setQueueCallback(() => {\r\n\t\t\t\tresolve(true);\r\n\t\t\t});\r\n\t\t\tso.loadQueue();\r\n\t\t});\r\n\t}\r\n\tasync createSync(file, stream = false) {\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tfile = this.directory + file + this.extension;\r\n\t\t\tlet found = -1;\r\n\t\t\tfound = this.findSound(file);\r\n\t\t\tlet returnObject = null;\r\n\t\t\tif (found == -1 || found.sound.data == null) {\r\n\t\t\t\treturnObject = new SoundObjectItem(file, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\t\tthis.sounds.push(returnObject);\r\n\t\t\t\tif (stream) resolve(returnObject);\r\n\t\t\t} else {\r\n\t\t\t\treturnObject = new SoundObjectItem(found.sound.data, () => { if (!stream) this.doneLoading(); }, 0, stream);\r\n\t\t\t\tresolve(returnObject);\r\n\t\t\t}\r\n\t\t\treturnObject.fileName = file; //otherwise html element fileNames get fucked up.\r\n\t\t\tif (stream) resolve(returnObject);\r\n\t\t\tif (!stream) {\r\n\t\t\t\treturnObject.sound.once('loaded', () => {\r\n\t\t\t\t\tresolve(returnObject);\r\n\t\t\t\t\tthis.doneLoading();\r\n\t\t\t\t});// End\r\n\t\t\t}//stream\r\n\t\t});// Promise\r\n\t}\r\n\tasync playSync(file) {\r\n\t\tlet snd = await so.createSync(file);\r\n\t\tawait snd.playSync();\r\n\t\tsnd.destroy();\r\n\t}\r\n\r\n\tenqueue(file, stream = false) {\r\n\t\tfile = this.directory + file + this.extension;\r\n\t\tthis.queue.push({ file, stream });\r\n\t\tthis.queueLength = this.queue.length;\r\n\t}\r\n\r\n\tloadQueue() {\r\n\r\n\t\tthis.handleQueue();\r\n\t\tthis.loadingQueue = true;\r\n\r\n\t}\r\n\tsetQueueCallback(callback) {\r\n\t\tthis.queueCallback = callback;\r\n\t}\r\n\tresetQueue() {\r\n\t\tthis.queue = [];\r\n\t\tthis.loadingQueue = false;\r\n\t}\r\n\thandleQueue() {\r\n\t\tif (this.queue.length > 0) {\r\n\t\t\tif (typeof this.statusCallback != \"undefined\" && this.statusCallback != null) {\r\n\t\t\t\tthis.statusCallback(1 - this.queue.length / this.queueLength);\r\n\t\t\t}\r\n\t\t\tif (this.findSound(this.queue[0].file) != -1) {\r\n\t\t\t\tthis.queue.splice(0, 1);\r\n\t\t\t\tthis.handleQueue();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet file = this.queue[0].file;\r\n\t\t\tlet stream = this.queue[0].stream;\r\n\t\t\tthis.queue.splice(0, 1);\r\n\t\t\tthis.sounds.push(new SoundObjectItem(file, () => { this.handleQueue(); }, 1, stream));\r\n\r\n\t\t} else {\r\n\t\t\tthis.loadingQueue = false;\r\n\t\t\tif (typeof this.queueCallback != \"undefined\" && this.queueCallback != 0) {\r\n\t\t\t\tthis.queueCallback();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\tsetCallback(callback) {\r\n\t\tthis.loadedCallback = callback;\r\n\t}\r\n\tdoneLoading() {\r\n\t\tlet result = this.isLoading();\r\n\r\n\t\tif (result == 1) {\r\n\r\n\t\t\tif (typeof this.loadedCallback != \"undefined\" && this.loadedCallback != 0 && this.loadedCallback != null) {\r\n\t\t\t\tthis.loadedCallback();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tisLoading() {\r\n\t\tlet loading = 0;\r\n\t\tthis.loadedSounds = 0;\r\n\t\tthis.loadingSounds = 0;\r\n\t\tlet stillLoading = new Array();\r\n\t\tfor (let i = 0; i < this.sounds.length; i++) {\r\n\t\t\tif (typeof this.sounds[i] != \"undefined\") {\r\n\t\t\t\tif (this.sounds[i].loaded == false) {\r\n\t\t\t\t\tthis.loadingSounds++;\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.loadedSounds++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.loadedSounds / this.sounds.length;\r\n\t}\r\n\r\n\tplayOnce(file) {\r\n\t\tthis.oneShotSound = this.create(file).sound;\r\n\t\tthis.oneShotSound.stop();\r\n\t\tthis.oneShotSound.play();\r\n\t\tthis.oneShotSound.on(\"ended\", () => {\r\n\t\t\tif (this.oneShotSound.playing == false) this.oneShotSound.destroy();\r\n\t\t});\r\n\r\n\t}\r\n\tdestroy(file, callback = 0) {\r\n\t\tlet noMore = false;\r\n\t\tconst filename = this.directory + file + this.extension;\r\n\t\twhile (!noMore) {\r\n\t\t\tconst found = this.findSoundIndex(filename);\r\n\t\t\tif (found == -1) {\r\n\t\t\t\tnoMore = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.sounds[found].sound.unload();\r\n\t\t\t\tthis.sounds.splice(found, 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (callback != 0) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n\r\n\tkill(callback = 0) {\r\n\t\twhile (this.sounds.length > 0) {\r\n\t\t\tthis.sounds.splice(0, 1);\r\n\t\t}\r\n\r\n\t\tsono.destroyAll();\r\n\t\tif (callback != 0) {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n\r\n}\r\nexport let so = new SoundObject();","import \"babel-polyfill\";\r\n'use strict';\r\nimport $ from 'jquery';\r\nimport {KeyEvent} from './keycodes';\r\nimport {so} from './soundObject';\r\nimport {speech} from './tts';\r\nimport copy from 'copy-to-clipboard';\r\nif (runningText == undefined) {\r\n\tvar runningText = 0;\r\n}\r\nclass ScrollingText {\r\n\tconstructor(text, delimiter = '\\n', callback = 0) {\r\n\t\tthis.callback = callback;\r\n\r\n\t\tthis.text = text;\r\n\t\tthis.delimiter = delimiter;\r\n\t\tthis.splitText = this.text.split(delimiter);\r\n\t\tthis.currentLine = 0;\r\n\t\tthis.sndOpen = so.create('ui/textOpen');\r\n\t\tthis.sndContinue = so.create('ui/textScroll');\r\n\t\tthis.sndClose = so.create('ui/textClose');\r\n\t\tconst id = document.getElementById('touchArea');\r\n\t\t// This.hammer = new Hammer(id);\r\n\t\tthis.init();\r\n\t\tif (this.callback == 0) {\r\n\t\t\treturn this.prom = new Promise(resolve => {\r\n\t\t\t\t\tthis.res = resolve;\r\n\t\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tinit() {\r\n\t\tconst that = this;\r\n\t\trunningText = this;\r\n\t\tdocument.addEventListener('keydown', this.handleKeys);\r\n\t\t// This.hammer.on(\"swipeleft swiperight\", function() { that.handleTap(0); });\r\n\t\t// this.hammer.on(\"tap\", function() { that.handleTap(1); });\r\n\t\tthis.sndOpen.play();\r\n\t\tthis.currentLine = 0;\r\n\t\tthis.readCurrentLine();\r\n\t}\r\n\r\n\thandleKeys(event) {\r\n\t\tswitch (event.which) {\r\n\t\t\tcase KeyEvent.DOM_VK_UP:\r\n\t\t\tcase KeyEvent.DOM_VK_DOWN:\r\n\t\t\tcase KeyEvent.DOM_VK_LEFT:\r\n\t\t\tcase KeyEvent.DOM_VK_RIGHT:\r\n\t\t\t\trunningText.readCurrentLine();\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase KeyEvent.DOM_VK_C:\r\n\t\t\t\trunningText.copyCurrentLine();\r\n\t\t\t\tbreak;\r\n\t\t\tcase KeyEvent.DOM_VK_RETURN:\r\n\t\t\t\trunningText.advance();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\thandleTap(action) {\r\n\t\tif (action == 0) {\r\n\t\t\tthis.readCurrentLine();\r\n\t\t}\r\n\r\n\t\tif (action == 1) {\r\n\t\t\tthis.advance();\r\n\t\t}\r\n\t}\r\n\r\n\treadCurrentLine() {\r\n\t\tif (this.splitText[this.currentLine][0] == '!') {\r\n\t\t\tconst str = this.splitText[this.currentLine].substr(1);\r\n\t\t\tconst snd = so.create(str, true);\r\n\t\t\tsnd.play();\r\n\t\t\tsnd.sound.once('end', () => {\r\n\t\t\t\t\tthis.advance();\r\n\t\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tspeech.speak(this.splitText[this.currentLine]);\r\n\t\t}\r\n\t}\r\ncopyCurrentLine() {\r\n\t\t\tcopy(this.splitText[this.currentLine]);\t\r\n\t\t\tthis.advance();\r\n}\r\n\r\n\tadvance() {\r\n\t\tif (this.currentLine < this.splitText.length - 1) {\r\n\t\t\tthis.currentLine++;\r\n\t\t\tthis.sndContinue.play();\r\n\t\t\tthis.readCurrentLine();\r\n\t\t} else {\r\n\t\t\tthis.sndClose.play();\r\n\t\t\tthis.sndClose.unload();\r\n\t\t\tthis.sndOpen.unload();\r\n\t\t\tthis.sndContinue.unload();\r\n\t\t\tdocument.removeEventListener('keydown', this.handleKeys);\r\n\t\t\t//\t\t\tThis.hammer.unload();\r\n\t\t\tif (this.callback != 0) {\r\n\t\t\t\tthis.callback();\r\n\t\t\t} else {\r\n\t\t\t\tthis.res();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nexport {ScrollingText, speech};\r\n","'use strict';\r\nimport {lang} from './main';\r\nimport {utils} from './utilities';\r\nimport {speech} from './tts';\r\nimport {ScrollingText} from './scrollingText';\r\n\r\nclass Strings {\r\n\tconstructor() {\r\n\t\tthis.strings = {};\r\n\t\tthis.strings[1] = {\r\n\t\t\t// New English\r\nselectVoice:\"%1 voices available, use the up and down arrows to select a voice, enter when you're done.\",\r\n\t    mSelectVoice:\"text to speech voice\",\r\n\t    mLang: 'Change language',\r\n\t    newUpdate: 'There is a new version available! You have version %1, version %2 is available.',\r\n\t    mSapi: 'Use text to speech for the game',\r\n\t    mReader: 'Use your screen reader for the game',\r\n\r\n\t    newRate: 'This is a text to speech rate test. Please press enter when done',\r\n\t    rating: 'Press right and left arrow keys to change the rate. Press enter when done',\r\n\t    mRate: 'Change speech rate',\r\n\r\n\t    K: 'king',\r\n\t    Q: 'queen',\r\n\t    A: 'ace',\r\n\t    J: 'jack',\r\n\t    cspades: 'spades',\r\n\t    cdiamonds: 'diamonds',\r\n\t    cclubs: 'clubs',\r\n\t    chearts: 'hearts',\r\n\t    dq: 'This is a game of risk. You will risk losing %1 beatcoins. Continue?',\r\n\t    lang: 'English',\r\n\t    langs: 'Select your language',\r\n\t    mainmenu: 'main menu: arrow keys to select options, page up and page down raise and lower the music volume. You can also use the first letter of an option to move to it',\r\n\t    mSelect: 'Please select',\r\n\t    mBack: 'go back',\r\n\t    mStart: 'Start Game',\r\n\t    yes: 'Yes',\r\n\t    no: 'no',\r\n\t    ok: 'ok',\r\n\t\t};\r\n\t\tthis.strings[2] = {\r\n\t\t\t// New Spanish\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n\r\n\tget(what, rep = []) {\r\n\t\tlet str;\r\n\t\tif (typeof this.strings[lang][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[lang][what];\r\n\t\t} else if (typeof this.strings[1][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[1][what];\r\n\t\t} else {\r\n\t\t\treturn what;\r\n\t\t}\r\n\t\trep.forEach((v, i) => {\r\n\t\t\t\tconst i1 = Number(i) + 1;\r\n\t\t\t\tstr = str.replace('%' + i1, v);\r\n\t\t\t\t});\r\n\t\treturn str;\r\n\t}\r\n\r\n\tspeak(what, rep = []) {\r\n\t\tlet str;\r\n\t\tif (typeof this.strings[lang][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[lang][what];\r\n\t\t} else if (typeof this.strings[1][what] !== 'undefined') {\r\n\t\t\tstr = this.strings[1][what];\r\n\t\t} else {\r\n\t\t\tspeech.speak(what);\r\n\t\t}\r\n\t\trep.forEach((v, i) => {\r\n\t\t\t\tconst i1 = Number(i) + 1;\r\n\t\t\t\tstr = str.replace('%' + i1, v);\r\n\t\t\t\t});\r\n\t\tspeech.speak(str);\r\n\t}\r\n\r\n\tasync check(lng) {\r\n\t\tconst len = utils.objSize(this.strings) - 2;\r\n\t\tfor (const i in this.strings[1]) {\r\n\t\t\tif (!this.strings[lng].hasOwnProperty(i)) {\r\n\t\t\t\tawait new ScrollingText(i + ': ' + this.strings[1][i]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nexport var strings = new Strings();\r\n","import \"babel-polyfill\";\r\nconst { app } = require('electron').remote;\r\nimport { report } from './main';\r\n\r\n'use strict';\r\n\r\nimport { strings } from './strings';\r\nimport { utils } from './utilities'\r\nimport { lang, ttsVoice, ttsRate } from './main';\r\nimport { KeyboardInput } from './input.js';\r\nimport { KeyEvent } from './keycodes';\r\nconst useWebTTS = true;\r\nimport Speech from 'speak-tts' // es6\r\nclass TTS {\r\n\tconstructor(webTTS = true) {\r\n\t\tthis.voices = []\r\n\t\tthis.speechController = new KeyboardInput();\r\n\t\tthis.speechController.init();\r\n\t\tthis.ducking = false;\r\n\t\tif (lang == 1) this.lang = \"en\";\r\n\t\tif (lang == 2) this.lang = \"es\";\r\n\t\tthis.webTTS = webTTS;\r\n\t\tthis.synth = new Speech()\r\n\t\tthis.rate = 2;\r\n\t\tthis.speechController.justPressedEventCallback = (key) => {\r\n\t\t\tif (this.interrupt) this.speak(\"\", false);\r\n\t\t\tif (key == KeyEvent.VK_CONTROL || key == KeyEvent.DOM_VK_ESCAPE) {\r\n\t\t\t\tthis.speak(\"\", false);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.synth.init({\r\n\t\t\tlang: this.lang,\r\n\t\t\trate: this.rate,\r\n\t\t\tsplitSentences: false,\r\n\t\t})\r\n\t\t\t.then((data) => {\r\n\t\t\t\tthis.voices = data.voices;\r\n\t\t\t}).catch(e => {\r\n\t\t\t\treport(e);\r\n\t\t\t})\r\n\t}\r\n\tsetLanguage(lang) {\r\n\t\ttry {\r\n\t\t\tif (lang == 1) this.lang = \"en\";\r\n\t\t\tif (lang == 2) this.lang = \"es\";\r\n\t\t\tthis.synth.setLanguage(this.lang)\r\n\t\t} catch (err) {\r\n\t\t\treport(err);\r\n\t\t}\r\n\t}\r\n\tsetRate(r) {\r\n\t\tlet newRate = r;\r\n\t\tif (r < 1) newRate == 1;\r\n\t\tif (r > 10) newRate = 10;\r\n\t\tthis.rate = newRate;\r\n\t\tthis.synth.setRate(newRate);\r\n\t}\r\n\tspeak(text, queue = false) {\r\n\t\tlet sr = app.accessibilitySupportEnabled;\r\n\r\n\t\tif (sr) this.webTTS = false;\r\n\t\tif (!sr) this.webTTS = true;\r\n\t\tif (this.webTTS) {\r\n\t\t\ttry {\r\n\t\t\t\tif (typeof text == \"number\") {\r\n\t\t\t\t\ttext = text + \".\";\r\n\t\t\t\t\t//we need this because some voices fail to process numbers. Why? Don't ask me.\r\n\t\t\t\t}\r\n\t\t\t\tthis.synth.speak({\r\n\t\t\t\t\ttext: text,\r\n\t\t\t\t\tqueue: queue,\r\n\t\t\t\t\tlisteners: {\r\n\t\t\t\t\t\tonstart: () => {\r\n\t\t\t\t\t\t\tthis.duck();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonend: () => {\r\n\t\t\t\t\t\t\tthis.unduck();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonerror: (err) => {\r\n\t\t\t\t\t\t\t//this.setVoice(null,true);\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} catch {\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.duck();\r\n\t\t\tdocument.getElementById('speech').innerHTML = '';\r\n\t\t\tconst para = document.createElement('p');\r\n\t\t\tpara.appendChild(document.createTextNode(text));\r\n\t\t\tdocument.getElementById('speech').appendChild(para);\r\n\t\t}\r\n\t} // End speak()\r\n\r\n\tsetWebTTS(tts) {\r\n\t\tthis.webTTS = tts;\r\n\t}\r\n\r\n\tstop() {\r\n\t\tif (this.webTTS) {\r\n\t\t\tthis.synth.cancel();\r\n\t\t}\r\n\t}\r\n\tasync changeRate() {\r\n\t\tlet rate = speech.rate;\r\n\t\tconst inp = new KeyboardInput();\r\n\t\tinp.init();\r\n\t\tstrings.speak('rating');\r\n\t\twhile (!inp.isJustPressed(KeyEvent.DOM_VK_RETURN)) {\r\n\t\t\tawait utils.sleep(5);\r\n\t\t\tif (inp.isJustPressed(KeyEvent.DOM_VK_RIGHT)) {\r\n\t\t\t\trate += 0.25;\r\n\t\t\t\tif (rate > 10) rate = 10;\r\n\r\n\t\t\t\tspeech.setRate(rate)\r\n\t\t\t\tstrings.speak('newRate');\r\n\t\t\t}\r\n\t\t\tif (inp.isJustPressed(KeyEvent.DOM_VK_LEFT)) {\r\n\t\t\t\trate -= 0.25;\r\n\t\t\t\tif (rate < 1) rate = 1;\r\n\t\t\t\tspeech.setRate(rate)\r\n\t\t\t\tstrings.speak('newRate');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tchangeVoice(name) {\r\n\t\tlet voiceArray = []\r\n\t\tfor (var k in this.voices) {\r\n\t\t\tvoiceArray.push(this.voices[k].name)\r\n\t\t}\r\n\t\tif (voiceArray.includes(name)) {\r\n\t\t\tspeech.synth.setVoice(name);\r\n\t\t}\r\n\r\n\t}\r\n\tsetVoice(cb, silent = false) {\r\n\t\t//what language do we want?\r\n\t\tlet wl = \"en\";\r\n\t\tif (lang == 1) wl = \"en\";\r\n\t\tif (lang == 2) wl = \"es\";\r\n\t\tlet voiceArray = []\r\n\t\tfor (var k in this.voices) {\r\n\t\t\t//get the first part of the voice languages\r\n\t\t\tlet vl = this.voices[k].lang.split(\"-\")[0]\r\n\t\t\t//do we want this language?\r\n\t\t\tif (vl == wl) {\r\n\t\t\t\tvoiceArray.push(this.voices[k].name)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!silent) speech.speak(strings.get(\"selectVoice\", [voiceArray.length]));\r\n\t\tlet input = new KeyboardInput()\r\n\t\tlet selection = -1;\r\n\t\tinput.init();\r\n\t\tif (!silent) {\r\n\t\t\tinput.justPressedEventCallback = ((key) => {\r\n\t\t\t\tif (key == KeyEvent.DOM_VK_DOWN) {\r\n\t\t\t\t\tselection++;\r\n\t\t\t\t\tif (selection >= voiceArray.length) selection = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (key == KeyEvent.DOM_VK_UP) {\r\n\t\t\t\t\tselection--;\r\n\t\t\t\t\tif (selection <= -1) selection = voiceArray.length - 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (key != KeyEvent.DOM_VK_RETURN && (key == KeyEvent.DOM_VK_UP || key == KeyEvent.DOM_VK_DOWN)) { //dirty hack\r\n\t\t\t\t\tthis.synth.setVoice(voiceArray[selection]);\r\n\t\t\t\t\tspeech.speak(voiceArray[selection])\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t//it is enter\r\n\t\t\t\t\tif (selection != -1) { //don't crash if it's -1.\r\n\t\t\t\t\t\tinput.destroy();\r\n\t\t\t\t\t\tif (typeof cb !== \"undefined\") {\r\n\t\t\t\t\t\t\tcb(voiceArray[selection])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn voiceArray[selection]\r\n\t\t\t\t\t}\r\n\t\t\t\t}//enter action\r\n\t\t\t});//callback\r\n\t\t} //not silent\r\n\t\telse {\r\n\t\t\ttry {\r\n\t\t\t\tthis.synth.setVoice(voiceArray[0]);\r\n\t\t\t\treturn voiceArray[0];\r\n\t\t\t} catch (err) {\r\n\t\t\t\treport(err);\r\n\t\t\t\tthis.synth.setVoice(voiceArray[1]);\r\n\t\t\t\treturn voiceArray[1];\r\n\t\t\t} // catch block\r\n\t\t}//else\r\n\t}//function\r\n\tduck() {\r\n\t\tif (this.ducking) return;\r\n\t\tthis.ducking = true;\r\n\t\tif (typeof this.ducker !== \"undefined\") this.ducker.duck();\r\n\t}\r\n\tunduck() {\r\n\t\tthis.ducking = false;\r\n\t\tif (typeof this.ducker !== \"undefined\") this.ducker.unduck();\r\n\t}\r\n\r\n} // End class\r\nconst speech = new TTS(false);\r\n//if (process.platform == 'darwin') {\r\n//\tspeech.webTTS = true;\r\n//}\r\nexport { TTS, speech };\r\n","function Timer(callbacks, step) {\r\n\tlet last = 0;\r\n\tlet active = false;\r\n\tlet acc = 0;\r\n\tlet tick = 0;\r\n\tlet inc = step || 1 / 120;\r\n\tlet frameId;\r\n\r\n\tfunction onFrame(time) {\r\n\t\tif (last !== null) {\r\n\t\t\tacc += (time - last) / 1000;\r\n\t\t\twhile (acc > inc) {\r\n\t\t\t\tcallbacks.update(inc, tick);\r\n\t\t\t\ttick += 1;\r\n\t\t\t\tacc -= inc;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlast = time;\r\n\t\tcallbacks.render();\r\n\t\tif (active) {\r\n\t\t\tframeId = requestAnimationFrame(onFrame);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction start() {\r\n\t\tlast = null;\r\n\t\tactive = true;\r\n\t\tframeId = requestAnimationFrame(onFrame);\r\n\t}\r\n\r\n\tfunction stop() {\r\n\t\tactive = false;\r\n\t\tcancelAnimationFrame(frameId);\r\n\t}\r\n\tfunction change(value) {\r\n\t\tinc = value || 1 / 60;\r\n\t\tacc = inc;\r\n\t\ttick = 0;\r\n\t\tstop();\r\n\t\tstart();\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\t\tstop,\r\n\t\t\tchange\r\n\t};\r\n}\r\n\r\nmodule.exports = Timer;\r\n","'use strict';\r\n\r\nclass OldTimer {\r\n  constructor(run = true) {\r\n    this.elapsed;\r\n    if (run) {\r\n      this.paused = false;\r\n    }\r\n    if (!run) {\r\n      this.paused = true;\r\n    }\r\n    this.lastTime = 0;\r\n    this.pauseWhen = 0;\r\n    this.started = run;\r\n  }\r\n\r\n  isActive() {\r\n    return !paused & started;\r\n  }\r\n\r\n  get elapsed() {\r\n    if (this.paused) {\r\n      return this.pauseWhen - this.lastTime;\r\n    }\r\n    return performance.now() - this.lastTime;\r\n  }\r\n\r\n  pause() {\r\n    this.paused = true;\r\n    this.pauseWhen = performance.now();\r\n  }\r\n\r\n  reset() {\r\n    this.lastTime = performance.now();\r\n    this.pauseWhen = 0;\r\n    this.paused = false;\r\n    this.started = true;\r\n  }\r\n\r\n  restart() {\r\n    this.lastTime = performance.now();\r\n    this.pauseWhen = 0;\r\n    this.paused = false;\r\n    this.started = true;\r\n  }\r\n\r\n  resume() {\r\n    this.paused = false;\r\n    this.started = true;\r\n    this.lastTime += performance.now() - this.pauseWhen;\r\n  }\r\n}\r\nexport {OldTimer};\r\n","'use strict';\r\n\r\nclass Map {\r\n  constructor(maxX, maxY) {\r\n    this.maxX = maxX;\r\n    this.maxY = maxY;\r\n    this.tiles = [];\r\n  }\r\n\r\n  spawnPlatform(minX, maxX, minY, maxY, tile) {\r\n    this.tiles.push(new Tile(minX, maxX, minY, maxY, tile));\r\n    console.log('Tiles list: ' + this.tiles);\r\n  }\r\n\r\n  getTileAt(x, y) {\r\n    let temp = '';\r\n    for (let i = 0; i < this.tiles.length; i++) {\r\n      // Todo: Add the ability to return right in this loop, not outside of it so as to avoid nested tiles. This should be optional, of course.\r\n      if (this.tiles[i].here(x, y)) {\r\n        temp = this.tiles[i].surface;\r\n      }\r\n    }\r\n    console.log('Tile is ' + temp);\r\n    return temp\r\n  }\r\n}\r\n\r\nclass Tile {\r\n  constructor(minX, maxX, minY, maxY, surface) {\r\n    this.minX = minX;\r\n    this.maxX = maxX;\r\n    this.minY = minY;\r\n    this.maxY = maxY;\r\n    this.surface = surface;\r\n  }\r\n\r\n  here(x, y) {\r\n    if (x >= this.minX && x <= this.maxX && y >= this.minY && y <= this.maxY) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\nexport {Map};\r\n","'use strict';\r\n\r\nimport {speech} from './tts';\r\nimport Timer from './timer';\r\nimport {KeyboardInput} from './input.js';\r\nimport {KeyEvent} from './keycodes.js';\r\nimport {utils} from './utilities';\r\nimport {so} from './soundObject';\r\nimport {OldTimer} from './oldtimer';\r\nimport {Map} from './map';\r\n\r\nclass Game {\r\n  constructor() {\r\n    this.input = new KeyboardInput();\r\n    this.input.init();\r\n    this.timer = Timer({\r\n      update: () => this.update(),\r\n      render: () => this.render()\r\n    }, 1 / 60);\r\n    this.level = 1;\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.walkTime = 50;\r\n    this.walkTimer = new OldTimer();\r\n    this.map = new Map();\r\n    this.gameTimer = new OldTimer();\r\n  }\r\n\r\n  start() {\r\n    this.timer.start();\r\n    this.map.spawnPlatform(-1, 51, -1, 51, 'wall');\r\n    this.map.spawnPlatform(0, 50, 0, 50, 'tile');\r\n  }\r\n\r\n  update(dt) {\r\n    if (this.input.isJustPressed(KeyEvent.DOM_VK_L)) {\r\n      speech.speak('Level ' + this.level + '.');\r\n    }\r\n    if (this.input.isJustPressed(KeyEvent.DOM_VK_C)) {\r\n      speech.speak(this.x + ', ' + this.y + '.');\r\n    }\r\n    if (this.input.isJustPressed(KeyEvent.DOM_VK_UP)) {\r\n      if (this.walkTimer.elapsed >= this.walkTime) {\r\n        this.walkTimer.restart();\r\n        this.y++;\r\n        this.playSteps('up');\r\n      }\r\n    }\r\n    if (this.input.isJustPressed(KeyEvent.DOM_VK_LEFT)) {\r\n      if (this.walkTimer.elapsed >= this.walkTime) {\r\n        this.walkTimer.restart();\r\n        this.x--;\r\n        this.playSteps('left');\r\n      }\r\n    }\r\n    if (this.input.isJustPressed(KeyEvent.DOM_VK_DOWN)) {\r\n      if (this.walkTimer.elapsed >= this.walkTime) {\r\n        this.walkTimer.restart();\r\n        this.y--;\r\n        this.playSteps('down');\r\n      }\r\n    }\r\n    if (this.input.isJustPressed(KeyEvent.DOM_VK_RIGHT)) {\r\n      if (this.walkTimer.elapsed >= this.walkTime) {\r\n        this.walkTimer.restart();\r\n        this.x++;\r\n        this.playSteps('right');\r\n      }\r\n    }\r\n    if (this.input.isJustPressed(KeyEvent.DOM_VK_T)) {\r\n      speech.speak(utils.getReadableTime(this.gameTimer.elapsed));\r\n    }\r\n  }\r\n\r\n  render() {\r\n  }\r\n\r\n  playSteps(dir) {\r\n    if (this.map.getTileAt(this.x, this.y) == 'wall') {\r\n      let stepSnd = so.create('steps/wall');\r\n      stepSnd.play();\r\n      if (dir == 'up') {\r\n        this.y--;\r\n      } else if (dir == 'left') {\r\n        this.x++;\r\n      } else if (dir == 'down') {\r\n        this.y++;\r\n      } else if (dir == 'right') {\r\n        this.x--\r\n      }\r\n    } else {\r\n      let stepSnd = so.create('steps/' + utils.randomInt(1, 5));\r\n      stepSnd.play();\r\n    }\r\n  }\r\n}\r\n\r\nexport { Game }\r\n","export var gameID = '';\r\n\r\nimport {speech} from './tts';\r\nimport {Game} from './game';\r\n\r\nexport var ttsVoice;\r\nexport var ttsRate = 1;\r\n\r\ndocument.addEventListener('DOMContentLoaded', setup);\r\nasync function setup() {\r\n  document.getElementById('app').focus();\r\n  const game = new Game();\r\n  game.start();\r\n  console.log('Success!');\r\n}\r\n"]}